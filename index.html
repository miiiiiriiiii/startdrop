<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>별똥별 잡기 ✨</title>
  <style>
    :root { --pixel: 3; --accent: #ffff33; } /* 별 색상 노란색 */
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0; height: 100vh; overflow: hidden;
      font-family: ui-sans-serif, system-ui, -apple-system, "Noto Sans KR", Arial, sans-serif;
      image-rendering: pixelated;
      background: radial-gradient(1200px 600px at 50% -20%, #0a2a6b 0%, #050d25 60%, #000 100%);
      color: #fff;
    }
    .frame { position: relative; width: 100%; height: 100%; overflow: hidden; }

    .frame::before, .frame::after {
      content: ""; position: absolute; inset: 0; z-index: 0; pointer-events: none;
      background:
        radial-gradient(1px 1px at 10% 20%, #fff 99%, transparent 100%),
        radial-gradient(1px 1px at 30% 80%, #fff 99%, transparent 100%),
        radial-gradient(1px 1px at 70% 30%, #fff 99%, transparent 100%),
        radial-gradient(1px 1px at 85% 60%, #fff 99%, transparent 100%),
        radial-gradient(1px 1px at 55% 15%, #fff 99%, transparent 100%),
        radial-gradient(1px 1px at 15% 55%, #fff 99%, transparent 100%);
      opacity: 0.6; animation: twinkle 6s linear infinite;
    }
    .frame::after { filter: blur(0.5px); opacity: .4; animation-duration: 9s; }
    @keyframes twinkle { 0%{opacity:.3} 50%{opacity:.9} 100%{opacity:.3} }

    .hud { position: absolute; top: 10px; left: 10px; display: flex; gap: 20px; font-size: 20px; font-weight: 800; z-index: 5; text-shadow: 0 2px 0 #000; }

    .star {
      --size: 22px;
      position: absolute; z-index: 3;
      width: var(--size); height: var(--size);
      background: var(--accent);
      clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
      filter: drop-shadow(0 0 0 #000) drop-shadow(0 0 0 #000) drop-shadow(0 0 0 #000);
      border: 2px solid transparent;
      cursor: crosshair; touch-action: none;
      animation: fall linear forwards;
    }
    .star::before {
      content: ""; position: absolute; inset: -2px; z-index: -1; background: #000;
      clip-path: inherit; border-radius: 2px;
    }

    @keyframes fall { from { transform: translateY(-10%);} to { transform: translateY(110vh);} }

    .wish { position: absolute; font-size: 18px; font-weight: 900; color: #ffe6a6; text-shadow: 0 2px 0 #000, 2px 0 0 #000, -2px 0 0 #000, 0 -2px 0 #000; animation: pop .9s ease-out forwards; pointer-events: none; z-index: 6; }
    @keyframes pop { 0%{opacity:0; transform: scale(.8) translateY(0);} 30%{opacity:1;} 100%{opacity:0; transform: scale(1.15) translateY(-46px);} }

    .overlay { position: absolute; inset: 0; background: rgba(0,0,0,.65); display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; z-index: 10; color:#fff; }
    .overlay h1, .overlay h2 { margin: 0 0 10px; text-shadow: 0 2px 0 #000; }
    .overlay button { margin-top: 16px; padding: 10px 20px; font-size: 18px; font-weight: 800; cursor: pointer; border: 2px solid #000; border-radius: 6px; background: #ffff33; color:#000; }
  </style>
</head>
<body>
  <div class="frame" id="frame">
    <div class="hud">
      <div>점수: <span id="score">0</span></div>
      <div>시간: <span id="time">20</span>s</div>
    </div>
    <div class="overlay" id="overlay">
      <h1>별똥별 잡기 ✨</h1>
      <p>20초 동안 별을 클릭해 점수를 모아보세요!</p>
      <button id="startBtn">게임 시작</button>
    </div>
  </div>
  <script>
    (function(){
      const frame = document.getElementById('frame');
      const scoreEl = document.getElementById('score');
      const timeEl = document.getElementById('time');
      const overlay = document.getElementById('overlay');

      let score = 0;
      let timeLeft = 20;
      let spawnTimer = null;
      let tickTimer = null;
      let running = false;

      const $ = (sel, root=document) => root.querySelector(sel);
      const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
      const rand = (min, max) => Math.random() * (max - min) + min;

      function clearTimers(){ if (spawnTimer) clearInterval(spawnTimer); if (tickTimer) clearInterval(tickTimer); spawnTimer=null; tickTimer=null; }

      function resetScene(){
        clearTimers();
        $$('.star', frame).forEach(s => s.remove());
        score = 0; timeLeft = 20; running = false;
        scoreEl.textContent = score;
        timeEl.textContent = timeLeft;
      }

      function startGame(){
        resetScene();
        overlay.style.display = 'none';
        overlay.style.pointerEvents = 'none';
        running = true;
        spawnTimer = setInterval(spawnStar, 650);
        tickTimer = setInterval(() => { timeLeft -= 1; timeEl.textContent = timeLeft; if (timeLeft <= 0) endGame(); }, 1000);
      }

      function endGame(){
        running = false; clearTimers();
        $$('.star', frame).forEach(s => s.style.pointerEvents = 'none');
        overlay.style.display = 'flex'; overlay.style.pointerEvents = 'auto';
        overlay.innerHTML = `<h2>게임 종료! 점수: ${score}</h2><button id="retryBtn" class="btn">다시 하기</button>`;
      }

      function spawnStar(){
        if (!running) return;
        const star = document.createElement('div');
        star.className = 'star';
        const size = Math.round(rand(18, 28));
        star.style.setProperty('--size', size + 'px');
        const vw = window.innerWidth;
        const left = rand(size * 0.6, vw - size * 1.6);
        star.style.left = left + 'px';
        star.style.top = (-size - 10) + 'px';
        const dur = rand(3.8, 7.2);
        star.style.animationDuration = dur + 's';
        star.addEventListener('pointerdown', (e) => {
          if (!running || star.dataset.hit) return;
          star.dataset.hit = '1';
          score += 1; scoreEl.textContent = score;
          showWish(e.clientX, e.clientY);
          star.remove();
        });
        star.addEventListener('animationend', () => star.remove());
        frame.appendChild(star);
      }

      function showWish(x, y){
        const w = document.createElement('div');
        w.className = 'wish';
        w.textContent = 'Make a wish!';
        w.style.left = x + 'px';
        w.style.top = y + 'px';
        frame.appendChild(w);
        setTimeout(() => w.remove(), 900);
      }

      document.addEventListener('pointerdown', (e) => {
        const id = (e.target && e.target.id) || '';
        if (id === 'startBtn' || id === 'retryBtn') { e.preventDefault(); startGame(); }
      });
      document.addEventListener('click', (e) => {
        const id = (e.target && e.target.id) || '';
        if (id === 'startBtn' || id === 'retryBtn') { e.preventDefault(); startGame(); }
      });
      window.addEventListener('DOMContentLoaded', () => {
        const sb = document.getElementById('startBtn');
        if (sb) {
          sb.addEventListener('click', (e) => { e.preventDefault(); startGame(); });
          sb.addEventListener('pointerdown', (e) => { e.preventDefault(); startGame(); });
        }
      });
      document.addEventListener('keydown', (e) => { if (!running && (e.key === 'Enter' || e.key === ' ')) startGame(); });
      overlay.style.pointerEvents = 'auto';
    })();
  </script>
</body>
</html>
