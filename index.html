<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>별똥별 잡기 ✨</title>
  <style>
    :root { --pixel: 3; --accent: #ffcc00; }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: linear-gradient(180deg, #99ccff, #ffffff);
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: ui-sans-serif, system-ui, -apple-system, "Noto Sans KR", Arial, sans-serif;
      overflow: hidden;
      image-rendering: pixelated;
    }
    .frame { position: relative; width: 100%; height: 100%; overflow: hidden; }
    .hud { position: absolute; top: 10px; left: 10px; display: flex; gap: 20px; font-size: 20px; font-weight: 800; z-index: 5; }

    .star {
      position: absolute; z-index: 3;
      width: calc(4px * var(--pixel));
      height: calc(4px * var(--pixel));
      background: var(--accent);
      box-shadow:
        0 calc(-4px * var(--pixel)) 0 var(--accent),
        0 calc(4px * var(--pixel)) 0 var(--accent),
        calc(-4px * var(--pixel)) 0 0 var(--accent),
        calc(4px * var(--pixel)) 0 0 var(--accent);
      border: calc(2px * var(--pixel)) solid #000;
      border-radius: calc(2px * var(--pixel));
      cursor: crosshair;
      animation: fall linear forwards;
      touch-action: none; /* 모바일 탭 지연 방지 */
    }
    /* 보이지 않는 넉넉한 히트박스 (모바일 클릭 보정) */
    .star::after {
      content: "";
      position: absolute;
      left: calc(-4px * var(--pixel));
      top:  calc(-4px * var(--pixel));
      width: calc(4px * var(--pixel) + 8px * var(--pixel));
      height: calc(4px * var(--pixel) + 8px * var(--pixel));
      background: rgba(0,0,0,0);
    }

    @keyframes fall { from { transform: translateY(-10%);} to { transform: translateY(100vh);} }

    .wish { position: absolute; font-size: 20px; font-weight: 900; color: #ff66cc; text-shadow: 1px 1px 2px #000; animation: pop .8s
</head>
<body>
  <div class="frame" id="frame">
    <div class="hud">
      <div>점수: <span id="score">0</span></div>
      <div>시간: <span id="time">20</span>s</div>
    </div>
    <div class="overlay" id="overlay">
      <h1>별똥별 잡기 ✨</h1>
      <p>20초 동안 별을 클릭해 점수를 모아보세요!</p>
      <button id="startBtn">게임 시작</button>
    </div>
  </div>
  <script>
    const frame = document.getElementById('frame');
    const scoreEl = document.getElementById('score');
    const timeEl = document.getElementById('time');
    const overlay = document.getElementById('overlay');
    const startBtn = document.getElementById('startBtn');
    let score = 0;
    let timeLeft = 20;
    let spawnTimer, tickTimer;
    let running = false;

    function rand(min, max) { return Math.random() * (max - min) + min; }

    function startGame() {
      score = 0; timeLeft = 20;
      scoreEl.textContent = score;
      timeEl.textContent = timeLeft;
      overlay.style.display = 'none';
      running = true;
      spawnTimer = setInterval(spawnStar, 700);
      tickTimer = setInterval(() => {
        timeLeft--;
        timeEl.textContent = timeLeft;
        if (timeLeft <= 0) endGame();
      }, 1000);
    }

    function endGame() {
      running = false;
      clearInterval(spawnTimer);
      clearInterval(tickTimer);
      document.querySelectorAll('.star').forEach(s => s.remove());
      overlay.style.display = 'flex';
      overlay.innerHTML = `<h2>게임 종료! 점수: ${score}</h2><button id="retryBtn">다시 하기</button>`;
      document.getElementById('retryBtn').addEventListener('click', startGame);
    }

    function spawnStar() {
      if (!running) return;
      const star = document.createElement('div');
      star.className = 'star';
      star.style.left = rand(20, window.innerWidth - 40) + 'px';
      star.style.top = '-40px';
      const dur = rand(2, 4); // 별 낙하시간 짧게 조정
      star.style.animationDuration = dur + 's';
      star.addEventListener('click', (e) => {
        if (!running || star.dataset.hit) return;
        star.dataset.hit = '1';
        score++;
        scoreEl.textContent = score;
        showWish(e.clientX, e.clientY);
        star.remove();
      });
      star.addEventListener('animationend', () => star.remove());
      frame.appendChild(star);
    }

    function showWish(x, y) {
      const w = document.createElement('div');
      w.className = 'wish';
      w.textContent = 'Make a wish!';
      w.style.left = x + 'px';
      w.style.top = y + 'px';
      frame.appendChild(w);
      setTimeout(() => w.remove(), 800);
    }

    startBtn.addEventListener('click', startGame);
  </script>
</body>
</html>
